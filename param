python gaussian2xyz.py propanediol_scan.log scan > scan_geoms.xyz

split -l 15 scan_geoms.xyz

for i in x*; do (echo "#p M062X/6-311++G(d,p)" ; echo "" ; echo "SP" ; echo "" ; echo "0 1" ; tail -n +3 "$i" ; echo "") > "$i".com ; done

nohup $(for i in *com ; do g09 "$i" ; done) &

for i in x*log; do grep "SCF Done" "$i" | awk '{print $5}' ; done

python gaussian_dihedral.py 10 1 4 7 x*log > qm_scan.dat



antechamber -fi gout -i propanediol.log -fo mol2 -o propanediol.mol2 -nc 0 -c abcg2 -pf y -at gaff2
antechamber -fi mol2 -i propanediol.mol2 -fo ac -o propanediol.ac -pf y
prepgen -i propanediol.ac -o propanediol.prepin
parmchk2 -i propanediol.prepin -f mol2 -o propanediol.frcmod -s gaff2

source leaprc.gaff2
loadamberprep propanediol.prepin
mol = loadmol2 propanediol.mol2
saveoff mol propanediol.lib
quit

source leaprc.gaff2
loadamberparams propanediol.frcmod
loadoff propanediol.lib
loadamberprep propanediol.prepin
mol = loadmol2 propanediol.mol2
saveAmberParm mol propanediol.prmtop propanediol.rst7
savepdb mol propanediol.pdb
quit



python amb2gmx.py propanediol.prmtop propanediol.rst7

gmx editconf -f propanediol_converted.gro -bt triclinic -d 1.0 -o propanediol_converted.gro

#ifdef POSRES
[ dihedral_restraints ]
10 1 4 7 1 DIHE_VALUE 0 10000
12 7 4 1 1 177.95895 0 10000
#endif


define = -DPOSRES
integrator  = steep    
emtol       = 10.0     
emstep      = 0.0001      
nsteps      = 50000        
nstxout = 0
nstvout = 0
nstfout = 0
nstxout-compressed = 100
nstlist         = 1      
cutoff-scheme   = Verlet   
ns_type         = grid    
coulombtype     = Cutoff   
rcoulomb        = 1.0      
rvdw            = 1.0     
pbc             = xyz     


for i in $(tail -n +2 qm_scan.dat | awk '{print $1}'); do cp propanediol_converted.top propanediol_converted_dihe.top ; sed -i 's/DIHE_VALUE/'"$i"'/g' propanediol_converted_dihe.top ; gmx grompp -f min_steep.mdp -c propanediol_converted.gro -p propanediol_converted_dihe.top -o dihe_"$i".tpr ; gmx mdrun -deffnm dihe_"$i" ; done

for i in dihe_*gro; do gmx grompp -f min_steep.mdp -c "$i" -p propanediol_converted.top -o "$(echo "$i" | sed 's/\.gro//')".tpr ; gmx mdrun -deffnm "$(echo "$i" | sed 's/\.gro//')" ; done

python3 gromacs_dihedral.py dihe_*log

echo -e "box x 5 y 5 z 5 alpha 90 beta 90 gamma 90 \n replicatecell out testi.mol2 all " | cpptraj propanediol.mol2 -y propanediol.mol2

source leaprc.gaff2
loadamberparams propanediol.frcmod
loadoff propanediol.lib
loadamberprep propanediol.prepin
mol = loadmol2 propanediol.mol2
saveAmberParm mol propanediol.prmtop propanediol.rst7
savepdb mol propanediol.pdb
quit
